{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "6efbaa39",
   "metadata": {
    "_cell_guid": "18f54e62-a420-45b5-aa62-fef0f4c0808c",
    "_uuid": "f369c071-077e-48b2-b0c9-34396e9ded21",
    "collapsed": false,
    "execution": {
     "iopub.execute_input": "2025-05-23T05:14:21.349015Z",
     "iopub.status.busy": "2025-05-23T05:14:21.348690Z",
     "iopub.status.idle": "2025-05-23T05:14:25.828644Z",
     "shell.execute_reply": "2025-05-23T05:14:25.827560Z"
    },
    "jupyter": {
     "outputs_hidden": false
    },
    "papermill": {
     "duration": 4.484961,
     "end_time": "2025-05-23T05:14:25.830259",
     "exception": false,
     "start_time": "2025-05-23T05:14:21.345298",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Training RMSE: 43733.12\n",
      "Validation RMSE: 50604.83\n",
      "Training R²: 0.71\n",
      "Validation R²: 0.48\n",
      "        Id      SalePrice\n",
      "0     1461  169277.052498\n",
      "1     1462  187758.393989\n",
      "2     1463  183583.683570\n",
      "3     1464  179317.477511\n",
      "4     1465  150730.079977\n",
      "...    ...            ...\n",
      "1454  2915  167081.220949\n",
      "1455  2916  164788.778231\n",
      "1456  2917  219222.423400\n",
      "1457  2918  184924.279659\n",
      "1458  2919  187741.866657\n",
      "\n",
      "[1459 rows x 2 columns]\n"
     ]
    },
    {
     "data": {
      "image/png": "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eItHUnNzsyorK5WTkxPcFh0drZycHFVUVERwZce3d+9eVVdXh6w5ISFBo0aNCq65oqJCiYmJGjlyZHBMTk6OoqOjtXnz5uCY73znO4qNjQ2OycvL0549e/S3v/0tOObLx2kd03qcjqylM+rr6yVJSUlJkqTKykoFAoGQ4wwaNEgZGRkhmYcMGRLyhX95eXlqaGjQrl27OpSnI8+HjqwlHEePHtXSpUt1+PBheb1ex2YtKipSfn5+mzU5Me8HH3ygtLQ0feMb39DYsWNVVVXl2Kwvv/yyRo4cqZtvvlnJyckaMWKEfvOb3wT3O/nnVXNzs55//nndeeedioqKcuT5jRQKiqT/+7//09GjR9t8i21KSoqqq6sjtKoTa13XidZcXV2t5OTkkP0xMTFKSkoKGdPeHF8+xvHGfHn/ydYSrpaWFt1///264oordMkllwSPExsb2+YXRX51LZ3N09DQoL///e8dej50ZC0dsWPHDvXu3Vtut1t33323XnrpJWVmZjoy69KlS/X222+rtLS0zT6n5R01apQWL16sVatWaf78+dq7d6++/e1v6+DBg47LKkkfffSR5s+frwsuuECrV6/WxIkTde+99+q5554LWbMTf14tX75cdXV1uv3224PzO+38RkrEvuoeOJGioiLt3LlTb775ZqSXckpddNFF2r59u+rr6/WHP/xBhYWFWr9+faSX1eU++eQT3XffffL5fIqLi4v0ck65MWPGBP9/6NChGjVqlAYMGKAXX3xRPXv2jODKTo2WlhaNHDlSjz76qCRpxIgR2rlzpxYsWKDCwsIIr+7UWrhwocaMGaO0tLRIL8VxeAVF0tlnn60ePXq0+WRzTU2NUlNTI7SqE2td14nWnJqaqtra2pD9R44c0YEDB0LGtDfHl49xvDFf3n+ytYRj0qRJWrFihV5//XX1798/uD01NVXNzc2qq6s74Vo6m8fj8ahnz54dej50ZC0dERsbq/PPP19ZWVkqLS3VsGHD9Ktf/cpxWSsrK1VbW6tLL71UMTExiomJ0fr16zV37lzFxMQoJSXFUXm/KjExURdeeKE+/PBDx51bSerXr58yMzNDtg0ePDj4tpZTf159/PHHWrNmjf7pn/4puM2J5zdSKCg69o9EVlaW1q5dG9zW0tKitWvXyuv1RnBlxzdw4EClpqaGrLmhoUGbN28Ortnr9aqurk6VlZXBMevWrVNLS4tGjRoVHLNhwwYFAoHgGJ/Pp4suukh9+vQJjvnycVrHtB6nI2vpCGOMJk2apJdeeknr1q3TwIEDQ/ZnZWXJ5XKFHGfPnj2qqqoKybxjx46QH3Q+n08ejyf4A/RkeTryfOjIWjqjpaVFfr/fcVmvueYa7dixQ9u3bw/eRo4cqbFjxwb/30l5v+rQoUP6y1/+on79+jnu3ErSFVdc0eYrAd5//30NGDBAkjN/XknSokWLlJycrPz8/OA2J57fiIn0p3RtsXTpUuN2u83ixYvN7t27zYQJE0xiYmLIp6xPt4MHD5p33nnHvPPOO0aSefLJJ80777xjPv74Y2PMsUvlEhMTzZ/+9Cfz7rvvmhtuuKHdy/ZGjBhhNm/ebN58801zwQUXhFy2V1dXZ1JSUsy4cePMzp07zdKlS018fHyby/ZiYmLME088Yd577z0zffr0di/bO9laTmbixIkmISHBvPHGGyGX8DU2NgbH3H333SYjI8OsW7fObNu2zXi9XuP1eoP7Wy/fy83NNdu3bzerVq0y55xzTruX702ZMsW89957pqysrN3L9072fDjZWk7moYceMuvXrzd79+417777rnnooYdMVFSUKS8vd1zW9nz5Kh6n5f35z39u3njjDbN3717z1ltvmZycHHP22Web2tpax2U15til4zExMeaRRx4xH3zwgXnhhRdMfHy8ef7554NjnPbz6ujRoyYjI8M8+OCDbfY57fxGCgXlS5555hmTkZFhYmNjzeWXX242bdoU0fW8/vrrRlKbW2FhoTHm2OVyDz/8sElJSTFut9tcc801Zs+ePSFzfP755+a2224zvXv3Nh6Px9xxxx3m4MGDIWP+/Oc/myuvvNK43W5z7rnnmscee6zNWl588UVz4YUXmtjYWHPxxRebV199NWR/R9ZyMu1llWQWLVoUHPP3v//d/OxnPzN9+vQx8fHx5oc//KHZv39/yDz/+7//a8aMGWN69uxpzj77bPPzn//cBAKBNn+2w4cPN7GxseYb3/hGyDFanez50JG1nMidd95pBgwYYGJjY80555xjrrnmmmA5cVrW9ny1oDgp7y233GL69etnYmNjzbnnnmtuueWWkO8EcVLWVq+88oq55JJLjNvtNoMGDTLPPvtsyH6n/bxavXq1kdTu45x4fiMhyhhjIvLSDQAAwHHwGRQAAGAdCgoAALAOBQUAAFiHggIAAKxDQQEAANahoAAAAOtQUAAAgHUoKAAAwDoUFAAAYB0KCgAAsA4FBQAAWIeCAgAArPP/ASj3Qp5tCkwaAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "from pathlib import Path\n",
    "from zipfile import ZipFile\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.linear_model import LinearRegression\n",
    "from sklearn.metrics import mean_squared_error, r2_score\n",
    "import os\n",
    "\n",
    "# Create data directory if it doesn't exist\n",
    "iskaggle = os.environ.get(\"KAGGLE_KERNEL_RUN_TYPE\", \"\")\n",
    "if iskaggle:\n",
    "    data_dir = Path(\"/kaggle/input/home-data-for-ml-course\")\n",
    "else:\n",
    "    import kaggle\n",
    "\n",
    "    data_dir = Path(\"data\")\n",
    "    data_dir.mkdir(exist_ok=True)\n",
    "\n",
    "    # Download competition data\n",
    "    competition = \"home-data-for-ml-course\"\n",
    "    kaggle.api.competition_download_files(competition, path=data_dir)\n",
    "    zip_path = data_dir / f\"{competition}.zip\"\n",
    "    assert zip_path.exists()\n",
    "\n",
    "    # Extract the zip file\n",
    "    with ZipFile(zip_path, \"r\") as zip_ref:\n",
    "        zip_ref.extractall(data_dir)\n",
    "\n",
    "data_df = pd.read_csv(data_dir / \"train.csv\")\n",
    "test_df = pd.read_csv(data_dir / \"test.csv\")\n",
    "sample_submission_df = pd.read_csv(data_dir / \"sample_submission.csv\")\n",
    "\n",
    "# View Columns and select features and target variable\n",
    "\n",
    "data_df.columns\n",
    "features = [\"GrLivArea\", \"YearBuilt\", \"FullBath\", \"BedroomAbvGr\", \"TotRmsAbvGrd\"]\n",
    "x = data_df[features]\n",
    "data_df.GrLivArea.mean()\n",
    "data_df.GrLivArea.std()\n",
    "y = data_df.SalePrice\n",
    "x.describe()\n",
    "\n",
    "# Check if data has na values\n",
    "x.isna().sum()\n",
    "\n",
    "# Check for outliers\n",
    "data_df[\"GrLivArea\"].hist()\n",
    "data_df[\"SalePrice\"].hist()\n",
    "data_df[\"GrLivArea\"].describe()\n",
    "data_df[\"SalePrice\"].describe()\n",
    "\n",
    "# Split the data into training and validation sets and check their distributions\n",
    "# It's important to split the data before scaling the features\n",
    "# because the scaler will use the training data to scale the features\n",
    "# and the validation data will be scaled using the training data statistics\n",
    "x_train, x_val, y_train, y_val = train_test_split(x, y, test_size=0.2)\n",
    "pd.concat([x_train, y_train], axis=1).describe()\n",
    "pd.concat([x_val, y_val], axis=1).describe()\n",
    "\n",
    "# Scale the features and target variable\n",
    "# We use fit_transform on the training data to learn the mean and standard deviation of the training data\n",
    "# We use transform on the validation data to scale it using the training data statistics.\n",
    "# The mean and standard deviation of the validation data should not be used because it will bias the model\n",
    "scaler = StandardScaler()\n",
    "x_train_scaled = scaler.fit_transform(x_train)\n",
    "x_val_scaled = scaler.transform(x_val)\n",
    "\n",
    "# Create and train the model\n",
    "model = LinearRegression()\n",
    "model.fit(x_train_scaled, y_train)\n",
    "\n",
    "# Make predictions\n",
    "train_predictions = model.predict(x_train_scaled)\n",
    "val_predictions = model.predict(x_val_scaled)\n",
    "\n",
    "# Calculate metrics\n",
    "train_rmse = mean_squared_error(y_train, train_predictions, squared=False)\n",
    "val_rmse = mean_squared_error(y_val, val_predictions, squared=False)\n",
    "train_r2 = r2_score(y_train, train_predictions)\n",
    "val_r2 = r2_score(y_val, val_predictions)\n",
    "\n",
    "## This initial model is not very accurate so the validation R2 will vary quite a bit\n",
    "print(f\"Training RMSE: {train_rmse:.2f}\")\n",
    "print(f\"Validation RMSE: {val_rmse:.2f}\")\n",
    "print(f\"Training R²: {train_r2:.2f}\")\n",
    "print(f\"Validation R²: {val_r2:.2f}\")\n",
    "\n",
    "# Make predictions on the test set\n",
    "## See how sample submission is structured\n",
    "print(sample_submission_df)\n",
    "\n",
    "## Make predictions on the test set\n",
    "x_test = test_df[features]\n",
    "x_test_scaled = scaler.transform(x_test)\n",
    "test_predictions = model.predict(x_test_scaled)\n",
    "\n",
    "# Transform predictions back to original scale\n",
    "test_predictions_original = test_predictions * y.std() + y.mean()\n",
    "\n",
    "# Create submission file\n",
    "submission_df = pd.DataFrame(\n",
    "    {\"Id\": test_df.Id, \"SalePrice\": test_predictions_original.flatten()}\n",
    ")\n",
    "submission_csv = submission_df.to_csv(\"submission.csv\", index=False)\n",
    "\n",
    "# Upload to Kaggle\n",
    "if False and not iskaggle:\n",
    "    kaggle.api.competition_submit(\n",
    "        \"submission.csv\",\n",
    "        \"House Price Prediction\",\n",
    "        competition,\n",
    "    )"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "databundleVersionId": 111096,
     "sourceId": 10211,
     "sourceType": "competition"
    }
   ],
   "dockerImageVersionId": 31040,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.11"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 10.261276,
   "end_time": "2025-05-23T05:14:26.554117",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-05-23T05:14:16.292841",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
